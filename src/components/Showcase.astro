---
import type { CollectionEntry } from "astro:content";

type Props = CollectionEntry<"pages">["data"]["showcase"];

const {
  label,
  title,
  highlight,
  description,
  mainImage,
  videoUrl,
  rightImage,
  features,
} = Astro.props as Props;
---

<section
  id="showcase-section"
  class="py-20 px-6 md:px-12 max-w-7xl mx-auto transition-colors duration-300"
>
  <div class="text-center mb-16">
    <span class="text-blue-500 font-semibold uppercase tracking-wider text-sm"
      >{label}</span
    >
    <h2 class="text-3xl md:text-5xl font-bold mt-2 font-outfit">
      {title}
      <span class="text-blue-500">{highlight}</span>
    </h2>
    <p class="text-gray-400 mt-4 max-w-2xl mx-auto">
      {description}
    </p>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Large Image/Video Area -->
    <div
      class="showcase-item lg:col-span-2 relative rounded-3xl overflow-hidden group h-[500px] opacity-0 translate-y-8"
    >
      <div
        class="absolute inset-0 bg-gray-900 flex items-center justify-center"
      >
        {
          videoUrl ? (
            <video
              src={videoUrl}
              poster={mainImage}
              autoplay
              loop
              muted
              playsinline
              class="w-full h-full object-cover"
            />
          ) : (
            <>
              <img
                src={mainImage}
                alt="City Street Screen"
                class="w-full h-full object-cover opacity-80 group-hover:scale-105 transition-transform duration-700"
              />
              <div class="absolute inset-0 flex items-center justify-center">
                <div class="w-16 h-16 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center border border-white/30 cursor-pointer hover:bg-white/30 transition-all">
                  <svg
                    class="w-6 h-6 text-white ml-1"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path d="M8 5v14l11-7z" />
                  </svg>
                </div>
              </div>
            </>
          )
        }
      </div>
    </div>

    <!-- Right Side Info Card -->
    <div
      class="showcase-item bg-blue-900/40 backdrop-blur-sm border border-blue-500/20 rounded-3xl p-8 flex flex-col justify-end relative overflow-hidden opacity-0 translate-y-8"
    >
      <!-- Background Image if present -->
      {
        rightImage && (
          <div class="absolute inset-0">
            <img
              src={rightImage}
              alt=""
              class="w-full h-full object-cover opacity-40 mix-blend-overlay"
            />
            <div class="absolute inset-0 bg-gradient-to-b from-blue-900/80 to-black/80" />
          </div>
        )
      }

      <!-- Decor -->
      <div
        class="absolute top-0 right-0 w-32 h-32 bg-blue-600/20 rounded-full blur-3xl"
      >
      </div>

      <div class="relative z-10">
        <h3 class="text-2xl font-bold mb-6 font-outfit">
          You can't skip the screen while waiting for coffee.
        </h3>

        <ul class="space-y-4">
          {
            features.map((feature) => (
              <li class="flex items-start gap-3">
                <svg
                  class="w-6 h-6 text-blue-400 shrink-0"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d={
                      feature.icon ||
                      "M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                    }
                  />
                </svg>
                <span class="text-gray-300">{feature.text}</span>
              </li>
            ))
          }
        </ul>
      </div>
    </div>
  </div>

  <script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    gsap.to(".showcase-item", {
      scrollTrigger: {
        trigger: ".showcase-item",
        start: "top 80%",
      },
      y: 0,
      opacity: 1,
      duration: 0.8,
      stagger: 0.2,
      ease: "power2.out",
    });
  </script>

  <style>
    :global([data-theme="light"]) #showcase-section h2 {
      color: #000000;
    }
    :global([data-theme="light"]) #showcase-section p {
      color: #4b5563;
    }

    :global([data-theme="light"]) .showcase-item {
      background: #ffffff !important;
      border-color: #e5e7eb !important;
      box-shadow:
        0 4px 6px -1px rgba(0, 0, 0, 0.1),
        0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    /* Override internal dark backgrounds */
    :global([data-theme="light"]) .bg-gray-900 {
      background-color: #f8fafc !important;
      border: 1px solid #e2e8f0;
    }

    /* Exception: Keep the Blue Card (Right Side) Blue */
    :global([data-theme="light"]) .showcase-item.bg-blue-900\/40 {
      background-color: rgba(30, 58, 138, 0.4) !important; /* blue-900/40 */
      border-color: rgba(59, 130, 246, 0.2) !important; /* blue-500/20 */
      box-shadow: none !important;
    }

    :global([data-theme="light"]) .showcase-item.bg-blue-900\/40 h3,
    :global([data-theme="light"]) .showcase-item.bg-blue-900\/40 span,
    :global([data-theme="light"]) .showcase-item.bg-blue-900\/40 li span {
      color: white !important; /* Keep text white on blue bg */
    }

    :global([data-theme="light"]) .showcase-item.bg-blue-900\/40 svg {
      color: #60a5fa !important; /* blue-400 */
    }

    /* Hide gradients/blurs in light mode for cleaner look - BUT keep for blue card */
    :global([data-theme="light"])
      .bg-gradient-to-b:not(.showcase-item.bg-blue-900\/40 *),
    :global([data-theme="light"])
      .blur-3xl:not(.showcase-item.bg-blue-900\/40 *) {
      opacity: 0;
    }
  </style>
</section>
